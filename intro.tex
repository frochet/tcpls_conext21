% !TEX root = ./paper.tex
The Transmission Control Protocol (\tcp) \cite{rfc793} is one of the most
critical protocols in today's Internet. A wide range of applications uses it for
reliable transfers. During the last four decades, \tcp evolved under the
pressure of competing protocols. During the 1980s, software-based \tcp
implementations were considered too slow. Researchers proposed new transport
protocols such as \xtp~\cite{sanders1990xpress} which could be implemented in
hardware. Meanwhile, \tcp implementations got a considerable speed
boost~\cite{clark1989analysis}, and \xtp disappeared. The \tcp speed boost and
usage triggered the development of various important \tcp extensions, including
timestamps and large windows~\cite{rfc1323} or Selective
Acknowledgments~\cite{rfc2018}.

During the late nineties, early 2000s, transport protocol researchers explored
alternatives to \tcp. The IETF standardized two new transport protocols:
\dccp~\cite{kohler2006designing} and \sctp~\cite{rfc4960}. We rarely use \dccp
today. Despite its benefits (support for multihoming, better design, and
extensibility), only niche applications use it. This limited deployment is
probably due to two different factors. First, \sctp forced the applications to
use a new API. Second, the Internet contains various middleboxes (NAT,
firewalls, etc.) that often block packets that do not carry \tcp or
\udp~\cite{honda2011still}.  \sctp initially supported multihoming by switching
from one path to another. It was later extended to use different
paths continuously~\cite{iyengar2006concurrent}.  Multipath
\tcp~\cite{rfc6824,raiciu2012hard} brought similar capabilities to \tcp, and
included a coupled congestion control scheme~\cite{wischik2011design}, later
brought to \sctp as well. This particular succession of events shows how
different designs can collaborate to advance each other.

In the mid-nineties, the Secure Socket Layer (SSL) protocol was proposed to
secure emerging e-commerce websites~\cite{draft-hickman-netscape-ssl}. SSL
evolved in different versions of the Transport Layer Security (\tls) protocol,
the most recent one being version 1.3~\cite{rfc8446}. Many details of the \tls
protocol have changed since the first version of SSL~\cite{kotzias2018coming}.
Nowadays, \tls is almost ubiquitous on web servers~\cite{holz2019era} and many non-web applications use it~\cite{anderson2019tls}.

\quic started as a proprietary protocol used by Google to speed up web
transfers~\cite{roskind2013quic,langley2017quic}. During the last years, it
evolved into a complete transport protocol whose standardization is being
finalized within the IETF~\cite{draft-ietf-quic-transport}. \quic combines the
functions that are usually found in \tcp, \tls, and HTTP/2. A key characteristic
of \quic is that it encrypts almost all the packets, including most of their
headers. Although \quic is essentially a new transport protocol, it does not run
directly above IP in contrast with \sctp or \tcp. \quic runs above \udp. With
this choice, \quic can be implemented as a user-space library, and \quic packets
can pass through middleboxes.

Does the standardization of \quic marks the end of the \tcp era and implies that
all applications and transport research will move to \quic?  We do not think
so. History tells us that \tcp has evolved with competing transport protocols.
\quic is today's competitor, but there is still plenty of room to improve \tcp.

In this paper, we take a step back. As \quic closely couples the reliability and
security mechanisms, we reconsider the separation between \tcp and \tls.  In
this paper, we combine both \tcp and \tls 1.3 in a single fast, flexible, and
secure protocol called \textbf{\tcpls}\footnote{We presented a preliminary version of this
work in a workshop paper~\cite{rochet2020tcpls}.}. We have
designed \tcpls with three goals in mind. First, \tcpls exposes modern transport
features, such as multipath capabilities, to the application. Second, \tcpls
solves \tcp's extensibility issues in \tcp by relying on the \tls handshake for
\tcp options negotiation and by including \tcp options inside \tls records.
Finally, we draw a path to make \tcpls an excellent challenger to \quic.  With that in
mind, we have implemented \tcpls as a user-space library that exposes a powerful
API to applications but still relies on the high-performance in-kernel \tcp
stack. Our implementation uses \tls' flexible record layer to create a secure
control channel that the endpoints of a \tcpls session can use to exchange
control information. This channel enables different use cases such as connection
migration or seamless failovers without risking middlebox interference. Our lab
measurements indicate that our \tcpls prototype outperforms existing \quic
implementations in terms of raw performance while allowing more flexibility
for recovery and connection migration. Our \tcpls has been thought
with open access in mind and will be released upon this paper acceptance.

The remainder of this paper is organized as follows: Sec.~\ref{sec:background}
provides the required technical background; Sec.~\ref{sec:background-design}
discusses how we designed \tcpls, while Sec.~\ref{sec:prototype} focuses on how
we implemented \tcpls; Sec.~\ref{sec:evaluation} evaluates the performance and
behavior of \tcpls; Sec.~\ref{sec:related} discusses the related work;  finally, Sec.~\ref{sec:conclusion} concludes this paper by
summarizing its main achievements and discussing further directions.  This work
does not raise any ethical issues.

